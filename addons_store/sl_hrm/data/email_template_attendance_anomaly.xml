<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Email Template for Manager -->
    <record id="email_template_attendance_anomaly_manager" model="mail.template">
        <field name="name">è€ƒå‹¤ç•°å¸¸é€šçŸ¥ - ç®¡ç†å“¡</field>
        <field name="model_id" ref="model_hr_attendance_check"/>
        <field name="subject">ã€è€ƒå‹¤ç•°å¸¸é€šçŸ¥ã€‘${ctx.get('start_date_str')} ~ ${ctx.get('end_date_str')} ç•¶æœˆç•°å¸¸çµ±è¨ˆ</field>
        <field name="email_from">${(object.company_id.email or user.email or 'noreply@example.com')}</field>
        <field name="body_html" type="html">
<div style="font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px;">
    <h2 style="color: #d9534f; border-bottom: 2px solid #d9534f; padding-bottom: 10px;">
        âš ï¸ è€ƒå‹¤ç•°å¸¸é€šçŸ¥
    </h2>
    
    <div style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 20px 0;">
        <p><strong>çµ±è¨ˆæœŸé–“ï¼š</strong>${ctx.get('start_date_str')} ~ ${ctx.get('end_date_str')}</p>
        <p><strong>ç•°å¸¸å“¡å·¥æ•¸ï¼š</strong><span style="color: #d9534f; font-size: 18px; font-weight: bold;">${ctx.get('employee_count', 0)}</span> äºº</p>
        <p><strong>ç•°å¸¸è¨˜éŒ„æ•¸ï¼š</strong><span style="color: #d9534f; font-size: 18px; font-weight: bold;">${ctx.get('total_anomaly_count', 0)}</span> ç­†</p>
    </div>
    
    <h3 style="color: #333; margin-top: 30px;">ç•°å¸¸æ˜ç´°ï¼š</h3>
    
    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
        <thead>
            <tr style="background-color: #007bff; color: white;">
                <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">å“¡å·¥ç·¨è™Ÿ</th>
                <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">å§“å</th>
                <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">éƒ¨é–€</th>
                <th style="padding: 10px; text-align: center; border: 1px solid #ddd;">ç•°å¸¸æ¬¡æ•¸</th>
            </tr>
        </thead>
        <tbody>
            % for emp_data in ctx.get('employee_list', []):
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">${emp_data['employee_number']}</td>
                <td style="padding: 10px; border: 1px solid #ddd;">${emp_data['name']}</td>
                <td style="padding: 10px; border: 1px solid #ddd;">${emp_data['department']}</td>
                <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #d9534f; font-weight: bold;">${emp_data['anomaly_count']}</td>
            </tr>
            % endfor
        </tbody>
    </table>
    
    <div style="margin-top: 30px; padding: 15px; background-color: #fff3cd; border-left: 4px solid #ffc107; border-radius: 5px;">
        <p style="margin: 0;"><strong>ğŸ“Œ æé†’ï¼š</strong></p>
        <ul style="margin: 10px 0; padding-left: 20px;">
            <li>è«‹ç£ä¿ƒç›¸é—œå“¡å·¥å„˜å¿«æäº¤è£œå¡èªªæ˜å–®æˆ–è«‹å‡å–®</li>
            <li>ç•°å¸¸è¨˜éŒ„åŒ…å«ï¼šé²åˆ°ã€æ—©é€€ã€æœªåˆ·å¡ç­‰æƒ…æ³</li>
            <li>æ‚¨å¯ä»¥ç™»å…¥ç³»çµ±æŸ¥çœ‹è©³ç´°çš„ç•°å¸¸è¨˜éŒ„</li>
        </ul>
    </div>
    
    <div style="margin-top: 30px; text-align: center; padding: 20px; background-color: #f8f9fa; border-radius: 5px;">
        <a href="${object.get_base_url()}/web#action=sl_hrm.hr_attendance_check_manager_action&amp;view_type=list" 
           style="display: inline-block; padding: 12px 30px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
            æŸ¥çœ‹å‡ºå‹¤è¨˜éŒ„
        </a>
    </div>
    
    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; color: #666; font-size: 12px;">
        <p>æ­¤éƒµä»¶ç”±ç³»çµ±è‡ªå‹•ç™¼é€ï¼Œè«‹å‹¿ç›´æ¥å›è¦†ã€‚</p>
        <p>å¦‚æœ‰ç–‘å•ï¼Œè«‹è¯ç¹«äººè³‡å–®ä½ã€‚</p>
    </div>
</div>
        </field>
    </record>

    <!-- Email Template for Employee -->
    <record id="email_template_attendance_anomaly_employee" model="mail.template">
        <field name="name">è€ƒå‹¤ç•°å¸¸é€šçŸ¥ - å“¡å·¥</field>
        <field name="model_id" ref="model_hr_attendance_check"/>
        <field name="subject">ã€è€ƒå‹¤ç•°å¸¸æé†’ã€‘æ‚¨æœ‰ ${ctx.get('anomaly_count', 0)} ç­†å¾…è™•ç†çš„ç•°å¸¸è¨˜éŒ„</field>
        <field name="email_from">${(object.company_id.email or user.email or 'noreply@example.com')}</field>
        <field name="body_html" type="html">
<div style="font-family: Arial, sans-serif; max-width: 700px; margin: 0 auto; padding: 20px;">
    <h2 style="color: #ff9800; border-bottom: 2px solid #ff9800; padding-bottom: 10px;">
        âš ï¸ è€ƒå‹¤ç•°å¸¸æé†’
    </h2>
    
    <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
        <p style="margin: 0; font-size: 16px;">è¦ªæ„›çš„ <strong>${ctx.get('employee_name')}</strong>ï¼Œæ‚¨å¥½ï¼š</p>
    </div>
    
    <p style="line-height: 1.8;">
        ç³»çµ±æª¢æ¸¬åˆ°æ‚¨åœ¨ <strong>${ctx.get('start_date_str')} ~ ${ctx.get('end_date_str')}</strong> 
        æœŸé–“æœ‰ <span style="color: #d9534f; font-size: 18px; font-weight: bold;">${ctx.get('anomaly_count', 0)}</span> ç­†è€ƒå‹¤ç•°å¸¸è¨˜éŒ„ã€‚
    </p>
    
    <h3 style="color: #333; margin-top: 30px;">ç•°å¸¸æ˜ç´°ï¼š</h3>
    
    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
        <thead>
            <tr style="background-color: #ff9800; color: white;">
                <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">æ—¥æœŸ</th>
                <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">æ˜ŸæœŸ</th>
                <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">ä¸Šç­æ‰“å¡</th>
                <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">ä¸‹ç­æ‰“å¡</th>
                <th style="padding: 10px; text-align: left; border: 1px solid #ddd;">ç•°å¸¸èªªæ˜</th>
            </tr>
        </thead>
        <tbody>
            % for record in ctx.get('anomaly_list', []):
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">${record['date']}</td>
                <td style="padding: 10px; border: 1px solid #ddd;">${record['day_of_week']}</td>
                <td style="padding: 10px; border: 1px solid #ddd;">${record['check_in']}</td>
                <td style="padding: 10px; border: 1px solid #ddd;">${record['check_out']}</td>
                <td style="padding: 10px; border: 1px solid #ddd; color: #d9534f;">${record['memo']}</td>
            </tr>
            % endfor
        </tbody>
    </table>
    
    <div style="margin-top: 30px; padding: 15px; background-color: #d1ecf1; border-left: 4px solid #17a2b8; border-radius: 5px;">
        <p style="margin: 0;"><strong>ğŸ“Œ è™•ç†æ–¹å¼ï¼š</strong></p>
        <ul style="margin: 10px 0; padding-left: 20px;">
            <li>å¦‚ç‚ºæ¼æ‰“å¡ï¼Œè«‹ç™»å…¥ç³»çµ±æäº¤ã€Œè£œå¡èªªæ˜å–®ã€</li>
            <li>å¦‚ç‚ºè«‹å‡ï¼Œè«‹ç¢ºèªæ˜¯å¦å·²æäº¤è«‹å‡å–®</li>
            <li>å¦‚æœ‰ç–‘å•ï¼Œè«‹è¯ç¹«æ‚¨çš„ä¸»ç®¡æˆ–äººè³‡å–®ä½</li>
        </ul>
    </div>
    
    <div style="margin-top: 30px; text-align: center; padding: 20px; background-color: #f8f9fa; border-radius: 5px;">
        <a href="${object.get_base_url()}/web#action=sl_hrm.hr_attendance_check_action&amp;view_type=list" 
           style="display: inline-block; padding: 12px 30px; background-color: #ff9800; color: white; text-decoration: none; border-radius: 5px; font-weight: bold; margin-right: 10px;">
            æŸ¥çœ‹æˆ‘çš„å‡ºå‹¤è¨˜éŒ„
        </a>
        <a href="${object.get_base_url()}/web#action=sl_hrm.action_sl_attendance_repair&amp;view_type=form" 
           style="display: inline-block; padding: 12px 30px; background-color: #28a745; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
            æäº¤è£œå¡èªªæ˜
        </a>
    </div>
    
    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; color: #666; font-size: 12px;">
        <p>æ­¤éƒµä»¶ç”±ç³»çµ±è‡ªå‹•ç™¼é€ï¼Œè«‹å‹¿ç›´æ¥å›è¦†ã€‚</p>
        <p>å¦‚æœ‰ç–‘å•ï¼Œè«‹è¯ç¹«äººè³‡å–®ä½ã€‚</p>
    </div>
</div>
        </field>
    </record>
</odoo>
