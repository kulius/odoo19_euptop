<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- Form View -->
  <record id="attendance_repair_view_form" model="ir.ui.view">
    <field name="name">未打卡說明單</field>
    <field name="model">attendance.repair</field>
    <field name="arch" type="xml">
      <form>
        <header>
          <field name="state" widget="statusbar" statusbar_visible="draft,f_approve,refused,agree"/>
          <button name="to_f_approve" string="送出簽核" type="object" class="btn-primary" states="draft"/>
          <button name="to_draft" string="抽回簽核"  class="btn-primary" type="object" attrs="{'invisible': ['|', ('is_current_user', '!=', True), ('state', 'not in', ['f_approve'])]}"/>
<!--          <button name="to_confirm" states="validated,validated" string="管理者確認" type="object" class="btn-primary"/>-->
<!--          <button name="to_cancel" states="draft,validated,validated" string="取消" type="object" class="btn-primary"/>-->
<!--          <button name="to_draft" states="review,confirm,cancel,validated,validated" string="重置草稿" type="object" class="btn-primary"/>-->
<!--          <field name="state" widget="statusbar" statusbar_visible="draft,confirm,cancel"/>-->
        </header>
        <sheet>
          <group>
            <field name="name" attrs="{'readonly': [('is_readonly', '=', True)]}"/>
            <field name="employee_id" readonly="1"/>
            <field name="start_date" attrs="{'readonly': [('is_readonly', '=', True)]}"/>
          </group>

<!--            <field name="end_date" attrs="{'readonly': [('state', '!=', 'draft')]}"/>-->
          <group>
              <group>
                  <label for="hour_from"/>
                  <div class="o_row o_row_readonly">
                      <field name="hour_from" attrs="{'readonly': [('is_readonly', '=', True)]}"/>
                      <label for="hour_from" string=" : " />
                    <field name="min_from" attrs="{'readonly': [('is_readonly', '=', True)]}" />
                  </div>
              </group>
              <group>
                  <label for="hour_to"/>
                  <div class="o_row o_row_readonly">
                      <field name="hour_to" attrs="{'readonly': [('is_readonly', '=', True)]}"/>
                      <label for="hour_to" string=" : "/>
                      <field name="min_to" attrs="{'readonly': [('is_readonly', '=', True)]}" />
                   </div>
              </group>
          </group>
          <group>
            <field name="notes" attrs="{'readonly': [('is_readonly', '=', True)]}"/>
            <field name="attendance_information" widget="text"/>
            <field name="user_id" readonly="1"/>
            <field name="department_id" readonly="1"/>
            <field name="is_current_user" string="是否為目前使用者" invisible="1" />
            <field name="is_readonly" string="是否維讀" invisible="1"  />
          </group>
        </sheet>
      </form>

    </field>
  </record>

  <!-- Tree(list) View -->
  <record id="attendance_repair_view_tree" model="ir.ui.view">
    <field name="name">silk 未刷卡/未打卡申請單列表</field>
    <field name="model">attendance.repair</field>
    <field name="arch" type="xml">
      <list>
        <field name="validated" string="同意" optional="show"/>
        <field name="rejected" string="退回" optional="show"/>
        <field name="can_review" string="可簽核" optional="show"/>
        <field name="need_validation" string="需簽核" optional="show"/>
        <field name="next_review" string="下一關" optional="show"/>
        <field name="reviewer_ids" widget="many2many_tags" optional="show"/>
        <field name="state"/>
        <field name="employee_id" optional="show"/>
        <field name="name"/>
        <field name="start_date"/>
        <field name="end_date"/>
        <field name="notes" optional="hide"/>
        <field name="user_id" optional="hide"/>
        <field name="department_id" optional="hide"/>
      </list>
    </field>
  </record>

  <!-- Search View -->
  <record id="attendance_repair_view_search" model="ir.ui.view">
    <field name="name">attendance Search</field>
    <field name="model">attendance.repair</field>
    <field name="arch" type="xml">
      <search>
        <field name="name"/>
        <field name="user_id"/>
        <field name="department_id"/>
        <field name="start_date" filter_domain="[('start_date', '&gt;=' , self)]" string="未刷卡日期-起"/>
        <field name="start_date" filter_domain="[('start_date', '&lt;=' , self)]" string="未刷卡日期-迄"/>
        <separator />
          <filter
              name="needs_review"
              string="待簽核"
              domain="[('reviewer_ids','in',uid), ('state', 'not in', ['done', 'cancel','to approve'])]"
              help="我申請正等待審核"/>
          <filter
              name="tier_validated"
              string="己審核"
              domain="[('validated', '=', True)]"
              help="己通過審核"/>
        <searchpanel>
              <field name="state" icon="fa-address-book-o" enable_counters="1"/>
        </searchpanel>
      </search>




    </field>
  </record>

  <record id='attendance_repair_action' model='ir.actions.act_window'>
    <field name="name">未刷卡/未打卡申請單</field>
    <field name="res_model">attendance.repair</field>
<!--    <field name="domain">[('reviewer_id','=',uid)]</field>-->
    <field name="domain">[('user_id', '=', uid)]</field>
    <field name="view_mode">tree,form</field>
  </record>

    <record id='attendance_repair_manager_action' model='ir.actions.act_window'>
    <field name="name">管理-未刷卡/未打卡申請單</field>
    <field name="res_model">attendance.repair</field>
    <field name="view_mode">tree,form</field>
  </record>



</odoo>
